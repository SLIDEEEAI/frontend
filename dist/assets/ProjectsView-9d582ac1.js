import{a as w,u as k,d as P,b as N,r as $,c as l,o as b,e as o,f as c,g as a,t as u,h as I,i as S,j as V,k as B,l as f,w as m,n as y,F as q,m as A,p as j,_ as L}from"./index-0c1004f1.js";import{A as U}from"./AppSlidePreview-d5d49bbd.js";const x="https://slideeeeeee.ru/api/v1/",E=async()=>{try{return(await w.post(x+"user/presentations",{},{headers:{Authorization:`Bearer ${k().accessToken}`}})).data}catch(n){w.isAxiosError(n)?console.log(n):console.log("unexpected error: ",n)}},R={key:0},W={key:1},z=a("div",{class:"project-name"}," Про птиц средней полосы ",-1),F={class:"project-info"},T=P({__name:"ProjectItem",props:{projectId:{},userName:{}},setup(n){const{openInEditor:_,getProjectById:s,parsePresentationStyles:v}=N(),e=n,r=$({presentation:null,loading:!1,error:null});l(!0);const i=l(null),d=l(),h=l(.19),g=l({});async function C(p){r.loading=!0;try{const t=await s(p);t&&(r.presentation=t.json,g.value=v(t.json),d.value=t.json.slides[0])}catch(t){r.error=t.message||"Неизвестная ошибка"}finally{r.loading=!1}}return b(async()=>{h.value=i.value.offsetWidth/1920,C(e.projectId)}),(p,t)=>(o(),c("div",{class:"project-block-item",onClick:t[0]||(t[0]=Y=>V(_)(p.projectId))},[a("div",{class:"project-preview__wrap",ref_key:"previewWrap",ref:i},[r.loading?(o(),c("span",R,"Loading")):r.error?(o(),c("span",W,u(r.error),1)):d.value?(o(),I(U,{key:2,"scale-coefficient":h.value,slide:d.value,"preview-style":g.value},null,8,["scale-coefficient","slide","preview-style"])):S("",!0)],512),z,a("div",F,u(p.userName)+" · 18 часов назад ",1)]))}});const D={class:"projects-view"},M={class:"view-panel"},G={class:"tabs"},H={class:"sorts"},J={class:"tab-content"},K={class:"projects-loop"},O={key:0},Q={key:1},X=P({__name:"ProjectsView",setup(n){const _=l(k().currentUser.name),s=$({data:null,loading:!1,error:null});async function v(){s.loading=!0;try{const e=await E();e&&(s.data=e.presentations)}catch(e){s.error=e.message||"Неизвестная ошибка"}finally{s.loading=!1}}return b(()=>{v()}),(e,r)=>{const i=B("RouterLink");return o(),c("div",D,[a("div",M,[a("div",G,[f(i,{to:"/workspace/projects",class:y({active:!e.$route.query.tab})},{default:m(()=>[j("Все ")]),_:1},8,["class"]),f(i,{to:"/workspace/projects?tab=fav",class:y({active:e.$route.query.tab=="fav"})},{default:m(()=>[j("Избранное ")]),_:1},8,["class"]),f(i,{to:"/workspace/projects?tab=removed",class:y({active:e.$route.query.tab=="removed"})},{default:m(()=>[j("Удалённые ")]),_:1},8,["class"])]),a("div",H,u(e.$route.query.tab?e.$route.query.tab:"Все"),1)]),a("section",J,[a("div",K,[s.loading?(o(),c("div",O,"Загрузка...")):s.error?(o(),c("div",Q,"Ошибка: "+u(s.error),1)):(o(!0),c(q,{key:2},A(s.data,d=>(o(),I(T,{"user-name":_.value,"project-id":d.id},null,8,["user-name","project-id"]))),256))])])])}}});const se=L(X,[["__scopeId","data-v-4e0aeccd"]]);export{se as default};
